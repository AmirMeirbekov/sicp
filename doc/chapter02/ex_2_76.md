# [Глава 2](../index.md#Глава-2)

### Упражнение 2.76
Когда большая система с обобщенными операциями развивается, могут потребоваться новые типы объектов данных или новые операции. Для каждой из трех стратегий — обобщенные операции с явной диспетчеризацией, стиль, управляемый данными, и передача сообщений, - опишите, какие изменения нужно произвести в системе, чтобы добавить новый тип или новую операцию. Какая организация лучше подходит для системы, в которую часто добавляются новые типы? Какая для системы, где часто появляются новые операции?

#### Решение
1. Обобщенные операции с явной диспетчеризацией.
    * При добавлении типа:
      - добавить специфичные операции типа по числу операций в системе;
      - изменить все обобщенные операции, добавив в каждую условия проверки метки нового типа и вызова соответствующей операции нового типа.
    * При добавлении новой операции:
      - добавить для каждого типа специфичную реализацию этой операции;
      - добавить обобщенную операцию в систему.


2. Стиль, управляемый данными.
    * При добавлении типа:
      - добавить пакет со всеми операциями реализованными для этого типа;
      - добавить все реализации операций в таблицу типов с тегом этого типа.
    * При добавлении новой операции:
      - изменить все пакеты типов, добавив для каждого типа специфичную реализацию этой операции и добавить эту реализацию в таблицу типов;
      - добавить обобщенную операцию в систему.


3. Передача сообщений.
    * При добавлении типа:
      - добавить тип в виде конструктора с процедурой диспетчеризации, содержащей условия для каждой операции в системе;
    * При добавлении новой операции:
      - изменить все конструкторы, добавив в каждый из них условие диспетчеризации для новой операции и ее реализацию для каждого типа;
      - добавить обобщенную операцию в систему.

В случае добавление нового типа меньше всего изменений приходится делать при передаче сообщений. В случае же добавления новой операции, количество изменений, которое нужно произвести, примерно одинаково для каждого представления.

[Code](../../src/sicp/chapter02/2_76.clj) | [Test](../../test/sicp/chapter02/2_76_test.clj)
